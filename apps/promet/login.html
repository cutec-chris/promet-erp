<html>
<body>
<form id="loginform">
<fieldset>
	<label for="user">User :</label>
	<input type="text" name="user" id="user"/>
	<label for="pass">Password :</label>
	<input type="password" name="user" id="pass"/>
	<input type="submit" value="login"/>
</fieldset>
</form>
<script type="text/javascript" src="js/vendor/core-min.js"></script>
<script type="text/javascript" src="js/vendor/sha1-min.js"></script>
<script type="text/javascript" src="js/library.js"></script>
<script language="javascript">
document.getElementById('loginform').onsubmit = function(){
  return LoginStep1(document.getElementById('user').value, document.getElementById('pass').value);
}
function LoginStep1(usr, passw){
  user = usr;
  password = passw;
  document.getElementById('loginform').elements["pass"].value="";
  DoGet("http://localhost:8086/appbase?action=login&step=1&name="+encodeURIComponent(usr)+"&random="+encodeURIComponent(Math.random()));
  LoginTimer = window.setTimeout("LoginTimeout()", 500);
  return false;
}
function LoginTimeout(){
  window.clearTimeout(LoginTimer);
  document.getElementById('loginform').elements["pass"].focus();
  alert("Login fehlgeschlagen !");
}
function LoginStep2(salt){
  window.clearTimeout(LoginTimer);
  var Result="";
  var apw = password;
  for(i=0;i<password.length;i++)
    {
      Result += salt.substring(0,5);
      salt = salt.substring(5,salt.length);
      Result += apw.substring(0,1);
      apw = apw.substring(1,apw.length);
    }
  password=CryptoJS.SHA1(Result);
  DoGet("http://localhost:8086/appbase?action=login&step=2&p="+encodeURIComponent(password)+"&random="+encodeURIComponent(Math.random()));
  LoginTimer = window.setTimeout("LoginTimeout()", 500);
}
function LoginComplete(){
  window.clearTimeout(LoginTimer);
  if (document.referrer != "") {
     var referringURL = document.referrer;
     location.href = referringURL;
  }
  else alert("Login ok !");

}
</script
</body>
</html>
